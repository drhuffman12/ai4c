<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta id="repository-name" content="github.com/drhuffman12/ai4cr">
  <link href="../../css/style.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="../../js/doc.js"></script>
  <title>Ai4cr::NeuralNetwork::Backpropagation - github.com/drhuffman12/ai4cr</title>
</head>
<body>

<div id="types-list">
  <div id="search-box">
    <input type="search" id="search-input" placeholder="Search...">
  </div>

  <ul>
    <li><a href="../../index.html">README</a></li>
  </ul>

  <ul>
  
  <li class="parent open current" data-id="github.com/drhuffman12/ai4cr/Ai4cr" data-name="ai4cr">
      <a href="../../Ai4cr.html">Ai4cr</a>
      
        <ul>
  
  <li class="parent " data-id="github.com/drhuffman12/ai4cr/Ai4cr/Data" data-name="ai4cr::data">
      <a href="../../Ai4cr/Data.html">Data</a>
      
        <ul>
  
  <li class="parent " data-id="github.com/drhuffman12/ai4cr/Ai4cr/Data/Parameterizable" data-name="ai4cr::data::parameterizable">
      <a href="../../Ai4cr/Data/Parameterizable.html">Parameterizable</a>
      
        <ul>
  
  <li class=" " data-id="github.com/drhuffman12/ai4cr/Ai4cr/Data/Parameterizable/ClassMethods" data-name="ai4cr::data::parameterizable::classmethods">
      <a href="../../Ai4cr/Data/Parameterizable/ClassMethods.html">ClassMethods</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent open current" data-id="github.com/drhuffman12/ai4cr/Ai4cr/NeuralNetwork" data-name="ai4cr::neuralnetwork">
      <a href="../../Ai4cr/NeuralNetwork.html">NeuralNetwork</a>
      
        <ul>
  
  <li class=" current" data-id="github.com/drhuffman12/ai4cr/Ai4cr/NeuralNetwork/Backpropagation" data-name="ai4cr::neuralnetwork::backpropagation">
      <a href="../../Ai4cr/NeuralNetwork/Backpropagation.html">Backpropagation</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
</ul>

</div>

<div id="main-content">
<h1 class="type-name">

  <span class="kind">class</span> Ai4cr::NeuralNetwork::Backpropagation

</h1>


  <ul class="superclass-hierarchy"><li class="superclass"><a href="../../Ai4cr/NeuralNetwork/Backpropagation.html">Ai4cr::NeuralNetwork::Backpropagation</a></li><li class="superclass">Reference</li><li class="superclass">Object</li></ul>




  <h2>Overview</h2>

  <p>= Introduction</p>

<p>This is an implementation of a multilayer perceptron network, using
the backpropagation algorithm for learning.</p>

<p>Backpropagation is a supervised learning technique (described
by Paul Werbos in 1974, and further developed by David E.
Rumelhart, Geoffrey E. Hinton and Ronald J. Williams in 1986)</p>

<p>= Features</p>

<ul><li>Support for any network architecture (number of layers and neurons)</li><li>Configurable propagation function</li><li>Optional usage of bias</li><li>Configurable momentum</li><li>Configurable learning rate</li><li>Configurable initial weight function</li><li>100% Crystal code, no external dependency</li></ul>

<p>= Parameters</p>

<p>Use class method get_parameters_info to obtain details on the algorithm
parameters. Use set_parameters to set values for this parameters.</p>

<ul><li>:bias_disabled => If true, the algorithm will not use bias nodes.
  False by default.</li><li>:initial_weight_function => f(n, i, j) must return the initial
  weight for the conection between the node i in layer n, and node j in
  layer n+1. By default a random number in [-1, 1) range.</li><li>:propagation_function => By default:
  lambda { |x| 1/(1+Math.exp(-1*(x))) }</li><li>:derivative_propagation_function => Derivative of the propagation
  function, based on propagation function output.
  By default: lambda { |y| y*(1-y) }, where y=propagation_function(x)</li><li>:learning_rate => By default 0.25</li><li>:momentum => By default 0.1. Set this parameter to 0 to disable
  momentum</li></ul>

<p>= How to use it</p>

<p># Create the network with 4 inputs, 1 hidden layer with 3 neurons,
  # and 2 outputs
  net = Ai4cr::NeuralNetwork::Backpropagation.new([4, 3, 2])</p>

<p># Train the network</p>

<ol><li>times do |i|</li></ol>

<pre><code>net.train(example[i], result[i])</code></pre>

<p>end</p>

<p># Use it: Evaluate data with the trained network
  net.eval([12, 48, 12, 25])
=> [0.86, 0.01]</p>

<p>More about multilayer perceptron neural networks and backpropagation:</p>

<ul><li>http://en.wikipedia.org/wiki/Backpropagation</li><li>http://en.wikipedia.org/wiki/Multilayer_perceptron</li></ul>

<p>= About the project
Ported By:: Daniel Huffman
Url::       https://github.com/drhuffman12/ai4cr</p>

<p>Based on::  Ai4r
  Author::    Sergio Fierens
  License::   MPL 1.1
  Url::       http://ai4r.org</p>














  <h2>Defined in:</h2>
  
    
      <a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L88" target="_blank">ai4cr/neural_network/backpropagation.cr</a>
    
    <br/>
  





  <h2>Constructors</h2>
  <ul class="list-summary">
    
      <li class="entry-summary">
        <a href="#new%28structure%3AArray%28Int32%29%29-class-method" class="signature"><strong>.new</strong>(structure : Array(Int32))</a>
        
      </li>
    
  </ul>





  <h2>Instance Method Summary</h2>
  <ul class="list-summary">
    
      <li class="entry-summary">
        <a href="#activation_nodes%3AArray%28Array%28Float64%29%29-instance-method" class="signature"><strong>#activation_nodes</strong> : Array(Array(Float64))</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#activation_nodes%3D%28activation_nodes%29-instance-method" class="signature"><strong>#activation_nodes=</strong>(activation_nodes)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#backpropagate%28expected_output_values%29-instance-method" class="signature"><strong>#backpropagate</strong>(expected_output_values)</a>
        
          <div class="summary"><p>Propagate error backwards</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#calculate_error%28expected_output%29-instance-method" class="signature"><strong>#calculate_error</strong>(expected_output)</a>
        
          <div class="summary"><p>Calculate quadratic error for a expected output value Error = 0.5 <em> sum( (expected_value[i] - output_value[i])*</em>2 )</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#calculate_internal_deltas-instance-method" class="signature"><strong>#calculate_internal_deltas</strong></a>
        
          <div class="summary"><p>Calculate deltas for hidden layers</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#calculate_output_deltas%28expected_values%29-instance-method" class="signature"><strong>#calculate_output_deltas</strong>(expected_values)</a>
        
          <div class="summary"><p>Calculate deltas for output layer</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#check_input_dimension%28inputs%29-instance-method" class="signature"><strong>#check_input_dimension</strong>(inputs)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#check_output_dimension%28outputs%29-instance-method" class="signature"><strong>#check_output_dimension</strong>(outputs)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#deltas-instance-method" class="signature"><strong>#deltas</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#derivative_propagation_function-instance-method" class="signature"><strong>#derivative_propagation_function</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#bias_disabled%3ABool-instance-method" class="signature"><strong>#bias_disabled</strong> : Bool</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#bias_disabled%3D%28disable_bias%29-instance-method" class="signature"><strong>#bias_disabled=</strong>(bias_disabled)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#eval%28input_values%29-instance-method" class="signature"><strong>#eval</strong>(input_values)</a>
        
          <div class="summary"><p>Evaluates the input.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#eval_result%28input_values%29-instance-method" class="signature"><strong>#eval_result</strong>(input_values)</a>
        
          <div class="summary"><p>Evaluates the input and returns most active node E.g.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#feedforward%28input_values%29-instance-method" class="signature"><strong>#feedforward</strong>(input_values)</a>
        
          <div class="summary"><p>Propagate values forward</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#height-instance-method" class="signature"><strong>#height</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#height%3D%28height%29-instance-method" class="signature"><strong>#height=</strong>(height)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#hidden_qty-instance-method" class="signature"><strong>#hidden_qty</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#hidden_qty%3D%28hidden_qty%29-instance-method" class="signature"><strong>#hidden_qty=</strong>(hidden_qty)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#init_activation_nodes-instance-method" class="signature"><strong>#init_activation_nodes</strong></a>
        
          <div class="summary"><p>Initialize neurons structure.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#init_last_changes-instance-method" class="signature"><strong>#init_last_changes</strong></a>
        
          <div class="summary"><p>Momentum usage need to know how much a weight changed in the previous training.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#init_network-instance-method" class="signature"><strong>#init_network</strong></a>
        
          <div class="summary"><p>Initialize (or reset) activation nodes and weights, with the provided net structure and parameters.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#init_weights-instance-method" class="signature"><strong>#init_weights</strong></a>
        
          <div class="summary"><p>Initialize the weight arrays using function specified with the initial_weight_function parameter</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#initial_weight_function-instance-method" class="signature"><strong>#initial_weight_function</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#last_changes%3AArray%28Array%28Array%28Float64%29%29%29-instance-method" class="signature"><strong>#last_changes</strong> : Array(Array(Array(Float64)))</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#last_changes%3D%28last_changes%29-instance-method" class="signature"><strong>#last_changes=</strong>(last_changes)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#learning_rate%3AFloat64-instance-method" class="signature"><strong>#learning_rate</strong> : Float64</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#learning_rate%3D%28learning_rate%29-instance-method" class="signature"><strong>#learning_rate=</strong>(learning_rate)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#marshal_dump-instance-method" class="signature"><strong>#marshal_dump</strong></a>
        
          <div class="summary"><p>Custom serialization.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#marshal_load%28tup%29-instance-method" class="signature"><strong>#marshal_load</strong>(tup)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#momentum%3AFloat64-instance-method" class="signature"><strong>#momentum</strong> : Float64</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#momentum%3D%28momentum%29-instance-method" class="signature"><strong>#momentum=</strong>(momentum)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#propagation_function-instance-method" class="signature"><strong>#propagation_function</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#structure%3AArray%28Int32%29-instance-method" class="signature"><strong>#structure</strong> : Array(Int32)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#structure%3D%28structure%29-instance-method" class="signature"><strong>#structure=</strong>(structure)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#train%28inputs%2Coutputs%29-instance-method" class="signature"><strong>#train</strong>(inputs, outputs)</a>
        
          <div class="summary"><p>This method trains the network using the backpropagation algorithm.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#update_weights-instance-method" class="signature"><strong>#update_weights</strong></a>
        
          <div class="summary"><p>Update weights after @deltas have been calculated.</p></div>
        
      </li>
    
      <li class="entry-summary">
        <a href="#weights%3AArray%28Array%28Array%28Float64%29%29%29-instance-method" class="signature"><strong>#weights</strong> : Array(Array(Array(Float64)))</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#weights%3D%28weights%29-instance-method" class="signature"><strong>#weights=</strong>(weights)</a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#width-instance-method" class="signature"><strong>#width</strong></a>
        
      </li>
    
      <li class="entry-summary">
        <a href="#width%3D%28width%29-instance-method" class="signature"><strong>#width=</strong>(width)</a>
        
      </li>
    
  </ul>





<div class="methods-inherited">
  
    


    


    


  
    


    


    


  
</div>


  <h2>Constructor Detail</h2>
  
    <div class="entry-detail" id="new&#40;structure:Array&#40;Int32&#41;&#41;-class-method">
      <div class="signature">
        
        def self.<strong>new</strong>(structure : Array(Int32))

        <a class="method-permalink" href="#new%28structure%3AArray%28Int32%29%29-class-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L139" target="_blank">View source</a>]
        
      </div>
    </div>
  





  <h2>Instance Method Detail</h2>
  
    <div class="entry-detail" id="activation_nodes:Array&#40;Array&#40;Float64&#41;&#41;-instance-method">
      <div class="signature">
        
        def <strong>activation_nodes</strong> : Array(Array(Float64))

        <a class="method-permalink" href="#activation_nodes%3AArray%28Array%28Float64%29%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="activation_nodes&#61;&#40;activation_nodes&#41;-instance-method">
      <div class="signature">
        
        def <strong>activation_nodes=</strong>(activation_nodes)

        <a class="method-permalink" href="#activation_nodes%3D%28activation_nodes%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="backpropagate&#40;expected_output_values&#41;-instance-method">
      <div class="signature">
        
        def <strong>backpropagate</strong>(expected_output_values)

        <a class="method-permalink" href="#backpropagate%28expected_output_values%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Propagate error backwards</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L239" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="calculate_error&#40;expected_output&#41;-instance-method">
      <div class="signature">
        
        def <strong>calculate_error</strong>(expected_output)

        <a class="method-permalink" href="#calculate_error%28expected_output%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Calculate quadratic error for a expected output value
Error = 0.5 <em> sum( (expected_value[i] - output_value[i])*</em>2 )</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L342" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="calculate_internal_deltas-instance-method">
      <div class="signature">
        
        def <strong>calculate_internal_deltas</strong>

        <a class="method-permalink" href="#calculate_internal_deltas-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Calculate deltas for hidden layers</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L309" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="calculate_output_deltas&#40;expected_values&#41;-instance-method">
      <div class="signature">
        
        def <strong>calculate_output_deltas</strong>(expected_values)

        <a class="method-permalink" href="#calculate_output_deltas%28expected_values%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Calculate deltas for output layer</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L298" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="check_input_dimension&#40;inputs&#41;-instance-method">
      <div class="signature">
        
        def <strong>check_input_dimension</strong>(inputs)

        <a class="method-permalink" href="#check_input_dimension%28inputs%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L352" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="check_output_dimension&#40;outputs&#41;-instance-method">
      <div class="signature">
        
        def <strong>check_output_dimension</strong>(outputs)

        <a class="method-permalink" href="#check_output_dimension%28outputs%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L361" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="deltas-instance-method">
      <div class="signature">
        
        def <strong>deltas</strong>

        <a class="method-permalink" href="#deltas-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L123" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="derivative_propagation_function-instance-method">
      <div class="signature">
        
        def <strong>derivative_propagation_function</strong>

        <a class="method-permalink" href="#derivative_propagation_function-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L135" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="bias_disabled:Bool-instance-method">
      <div class="signature">
        
        def <strong>bias_disabled</strong> : Bool

        <a class="method-permalink" href="#bias_disabled%3ABool-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="bias_disabled&#61;&#40;bias_disabled&#41;-instance-method">
      <div class="signature">
        
        def <strong>bias_disabled=</strong>(bias_disabled)

        <a class="method-permalink" href="#bias_disabled%3D%28disable_bias%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="eval&#40;input_values&#41;-instance-method">
      <div class="signature">
        
        def <strong>eval</strong>(input_values)

        <a class="method-permalink" href="#eval%28input_values%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Evaluates the input.
E.g.</p>

<pre><code>net <span class="o">=</span> <span class="t">Backpropagation</span>.<span class="k">new</span>([<span class="n">4</span>, <span class="n">3</span>, <span class="n">2</span>])
net.eval([<span class="n">25</span>, <span class="n">32.3</span>, <span class="n">12.8</span>, <span class="n">1.5</span>])
    <span class="c"># &#61;&gt;  &#91;0.83, 0.03&#93;</span></code></pre></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L160" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="eval_result&#40;input_values&#41;-instance-method">
      <div class="signature">
        
        def <strong>eval_result</strong>(input_values)

        <a class="method-permalink" href="#eval_result%28input_values%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Evaluates the input and returns most active node
E.g.</p>

<pre><code>net <span class="o">=</span> <span class="t">Backpropagation</span>.<span class="k">new</span>([<span class="n">4</span>, <span class="n">3</span>, <span class="n">2</span>])
net.eval_result([<span class="n">25</span>, <span class="n">32.3</span>, <span class="n">12.8</span>, <span class="n">1.5</span>])
    <span class="c"># eval gives &#91;0.83, 0.03&#93;</span>
    <span class="c"># &#61;&gt;  0</span></code></pre></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L174" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="feedforward&#40;input_values&#41;-instance-method">
      <div class="signature">
        
        def <strong>feedforward</strong>(input_values)

        <a class="method-permalink" href="#feedforward%28input_values%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Propagate values forward</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L247" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="height-instance-method">
      <div class="signature">
        
        def <strong>height</strong>

        <a class="method-permalink" href="#height-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L111" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="height&#61;&#40;height&#41;-instance-method">
      <div class="signature">
        
        def <strong>height=</strong>(height)

        <a class="method-permalink" href="#height%3D%28height%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L91" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="hidden_qty-instance-method">
      <div class="signature">
        
        def <strong>hidden_qty</strong>

        <a class="method-permalink" href="#hidden_qty-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L115" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="hidden_qty&#61;&#40;hidden_qty&#41;-instance-method">
      <div class="signature">
        
        def <strong>hidden_qty=</strong>(hidden_qty)

        <a class="method-permalink" href="#hidden_qty%3D%28hidden_qty%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L91" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="init_activation_nodes-instance-method">
      <div class="signature">
        
        def <strong>init_activation_nodes</strong>

        <a class="method-permalink" href="#init_activation_nodes-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Initialize neurons structure.</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L263" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="init_last_changes-instance-method">
      <div class="signature">
        
        def <strong>init_last_changes</strong>

        <a class="method-permalink" href="#init_last_changes-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Momentum usage need to know how much a weight changed in the
previous training. This method initialize the @last_changes
structure with 0 values.</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L289" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="init_network-instance-method">
      <div class="signature">
        
        def <strong>init_network</strong>

        <a class="method-permalink" href="#init_network-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Initialize (or reset) activation nodes and weights, with the
provided net structure and parameters.</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L197" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="init_weights-instance-method">
      <div class="signature">
        
        def <strong>init_weights</strong>

        <a class="method-permalink" href="#init_weights-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Initialize the weight arrays using function specified with the
initial_weight_function parameter</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L274" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="initial_weight_function-instance-method">
      <div class="signature">
        
        def <strong>initial_weight_function</strong>

        <a class="method-permalink" href="#initial_weight_function-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L127" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="last_changes:Array&#40;Array&#40;Array&#40;Float64&#41;&#41;&#41;-instance-method">
      <div class="signature">
        
        def <strong>last_changes</strong> : Array(Array(Array(Float64)))

        <a class="method-permalink" href="#last_changes%3AArray%28Array%28Array%28Float64%29%29%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L89" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="last_changes&#61;&#40;last_changes&#41;-instance-method">
      <div class="signature">
        
        def <strong>last_changes=</strong>(last_changes)

        <a class="method-permalink" href="#last_changes%3D%28last_changes%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L89" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="learning_rate:Float64-instance-method">
      <div class="signature">
        
        def <strong>learning_rate</strong> : Float64

        <a class="method-permalink" href="#learning_rate%3AFloat64-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="learning_rate&#61;&#40;learning_rate&#41;-instance-method">
      <div class="signature">
        
        def <strong>learning_rate=</strong>(learning_rate)

        <a class="method-permalink" href="#learning_rate%3D%28learning_rate%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="marshal_dump-instance-method">
      <div class="signature">
        
        def <strong>marshal_dump</strong>

        <a class="method-permalink" href="#marshal_dump-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Custom serialization. It used to fail trying to serialize because
it uses lambda functions internally, and they cannot be serialized.
Now it does not fail, but if you customize the values of</p>

<ul><li>initial_weight_function</li><li>propagation_function</li><li>derivative_propagation_function
you must restore their values manually after loading the instance.</li></ul></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L213" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="marshal_load&#40;tup&#41;-instance-method">
      <div class="signature">
        
        def <strong>marshal_load</strong>(tup)

        <a class="method-permalink" href="#marshal_load%28tup%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L225" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="momentum:Float64-instance-method">
      <div class="signature">
        
        def <strong>momentum</strong> : Float64

        <a class="method-permalink" href="#momentum%3AFloat64-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="momentum&#61;&#40;momentum&#41;-instance-method">
      <div class="signature">
        
        def <strong>momentum=</strong>(momentum)

        <a class="method-permalink" href="#momentum%3D%28momentum%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L90" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="propagation_function-instance-method">
      <div class="signature">
        
        def <strong>propagation_function</strong>

        <a class="method-permalink" href="#propagation_function-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L131" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="structure:Array&#40;Int32&#41;-instance-method">
      <div class="signature">
        
        def <strong>structure</strong> : Array(Int32)

        <a class="method-permalink" href="#structure%3AArray%28Int32%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L89" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="structure&#61;&#40;structure&#41;-instance-method">
      <div class="signature">
        
        def <strong>structure=</strong>(structure)

        <a class="method-permalink" href="#structure%3D%28structure%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L89" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="train&#40;inputs,outputs&#41;-instance-method">
      <div class="signature">
        
        def <strong>train</strong>(inputs, outputs)

        <a class="method-permalink" href="#train%28inputs%2Coutputs%29-instance-method">#</a>
      </div>
      
        <div class="doc"><p>This method trains the network using the backpropagation algorithm.</p>

<p>input: Networks input</p>

<p>output: Expected output for the given input.</p>

<p>This method returns the network error:
=> 0.5 <em> sum( (expected_value[i] - output_value[i])*</em>2 )</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L187" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="update_weights-instance-method">
      <div class="signature">
        
        def <strong>update_weights</strong>

        <a class="method-permalink" href="#update_weights-instance-method">#</a>
      </div>
      
        <div class="doc"><p>Update weights after @deltas have been calculated.</p></div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L327" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="weights:Array&#40;Array&#40;Array&#40;Float64&#41;&#41;&#41;-instance-method">
      <div class="signature">
        
        def <strong>weights</strong> : Array(Array(Array(Float64)))

        <a class="method-permalink" href="#weights%3AArray%28Array%28Array%28Float64%29%29%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L89" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="weights&#61;&#40;weights&#41;-instance-method">
      <div class="signature">
        
        def <strong>weights=</strong>(weights)

        <a class="method-permalink" href="#weights%3D%28weights%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L89" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="width-instance-method">
      <div class="signature">
        
        def <strong>width</strong>

        <a class="method-permalink" href="#width-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L119" target="_blank">View source</a>]
        
      </div>
    </div>
  
    <div class="entry-detail" id="width&#61;&#40;width&#41;-instance-method">
      <div class="signature">
        
        def <strong>width=</strong>(width)

        <a class="method-permalink" href="#width%3D%28width%29-instance-method">#</a>
      </div>
      
      <br/>
      <div>
        
          [<a href="https://github.com/drhuffman12/ai4cr/blob/b3b9332ded0e2869c4b9ea895be649e48bc399bd/src/ai4cr/neural_network/backpropagation.cr#L91" target="_blank">View source</a>]
        
      </div>
    </div>
  




</div>

</body>
</html>
